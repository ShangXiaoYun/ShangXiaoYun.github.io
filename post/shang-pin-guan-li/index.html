<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>商品管理 | 晓云的个人博客</title>

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://shangxiaoyun.github.io/favicon.ico?v=1658597571731">
<link rel="stylesheet" href="https://shangxiaoyun.github.io/styles/main.css">



<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>



    <meta name="description" content="商品列表


添加商品。其中在商品基本信息有下拉商品分类菜单，因此还是需要调用 this.getCateList() 函数。


使用编程式导航跳转到新的页面   this.$router.push(’/goods/add’)


富文本编..." />
    <meta name="keywords" content="电商后台管理系统" />
  </head>
  <body>
    <div id="app" class="main">

      <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="https://shangxiaoyun.github.io">
        <img src="https://shangxiaoyun.github.io/images/avatar.png?v=1658597571731" class="site-logo">
        <h1 class="site-title">晓云的个人博客</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="/" class="site-nav">
            首页
          </a>
        
      
        
          <a href="/archives" class="site-nav">
            归档
          </a>
        
      
        
          <a href="/tags" class="site-nav">
            标签
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
    <div class="social-container">
      
        
      
        
      
        
      
        
      
        
      
    </div>
    <div class="site-description">
      一点记录
    </div>
    <div class="site-footer">
      Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | <a class="rss" href="https://shangxiaoyun.github.io/atom.xml" target="_blank">RSS</a>
    </div>
  </div>
</div>


      <div class="main-container">
        <div class="content-container" data-aos="fade-up">
          <div class="post-detail">
            <h2 class="post-title">商品管理</h2>
            <div class="post-date">2022-07-23</div>
            
            <div class="post-content" v-pre>
              <h2 id="商品列表"><strong>商品列表</strong></h2>
<ul>
<li>
<p>添加商品。其中在商品基本信息有下拉商品分类菜单，因此还是需要调用 this.getCateList() 函数。</p>
<ul>
<li>
<p>使用编程式导航跳转到新的页面   <code>this.$router.push(’/goods/add’)</code></p>
</li>
<li>
<p><strong>富文本编辑器   vue-quill-editor</strong></p>
</li>
<li>
<p>上传图片这里由于没有使用 axios 发起 ajax 请求，因此及时显示图片，也是无效的，这是因为 token 无效。在上传每一张图片时，手动为它指定一个 headers 请求头，在请求头中包含一个字段属性 Authorization，保存 token 值，即为其提供 token 验证。</p>
<pre><code class="language-jsx">headerObj: {
  Authorization: window.sessionStorage.getItem('token')
}
</code></pre>
</li>
<li>
<p>这里一个问题是 预览不了图片。handlePreview() 预处理函数中处理 previewPath ，把本地图片地址换成后台图片地址。</p>
<pre><code class="language-jsx">this.previewPath = file.response.data.url.replace(
	'http://120.78.137.246', 'https://lianghj.top'
)
</code></pre>
</li>
<li>
<p>添加商品时 goods_cat 商品分类需要以字符串的形式上传，而在级联选择器中是以数组的形式存在，因此需要用 join() 函数，但是不能在 this.addForm 上直接修改。因此采用<strong>深拷贝 cloneDeep。</strong></p>
<pre><code class="language-js">import _ from 'lodash'
const form = _.cloneDeep(this.addForm) //全新的对象
form.goods_cat = form.goods_cat.join(',')
</code></pre>
</li>
</ul>
</li>
<li>
<p>编辑商品信息</p>
<ul>
<li>商品分类通过下拉菜单选择，但是看不见原始分类，因此考虑用 Tag 标签可视化出来（这里后端接口有一个错误：如果只设置到二级分类，那么三级分类会被上一次的三级分类代替），因此我们规定所有商品都有三级分类，添加商品时设置。</li>
<li>由于下拉菜单中是商品全部分类，因此要调用 this.getCateList() 函数，这个函数在多个组件中都是用了，我们考虑用 Vuex 进行管理 （可改进）</li>
<li>尝试把根据 id 获取商品信息和商品分类提出来，但是都出错了，主要是异步请求的问题。</li>
</ul>
</li>
</ul>
<h2 id="商品分类"><strong>商品分类</strong></h2>
<p>主要显示和编辑商品分类。这里也使用到 this.getCateList() 函数。</p>
<ul>
<li>显示使用树形表格，columns 是表格各列的配置。type 为 template 时，对应的是作用域插槽。</li>
</ul>
<h2 id="分类参数"><strong>分类参数</strong></h2>
<p>主要对不同的商品分类添加静态属性和动态属性。选择商品分类中级联选择框中又是全部商品分类，需要调用 this.getCateList() 函数。甚至下拉菜单选择框和面包屑导航相似，在多个组件中使用，可以一起导出使用。</p>
<ul>
<li>
<p>添加动态参数/静态属性的对话框共用一个，通过 activeName （many/only）判断具体是哪一个，使用计算属性来判断。</p>
</li>
<li>
<p>当点击 tag 时，标签变为输入框，且输入框获得焦点。这是需要使用 <code>$nextTick</code> ，它的作用是当页面上的元素被重新渲染之后，才会执行回调函数，这样在回调函数中才能拿到原生 DOM 对象。</p>
<pre><code class="language-jsx">this.$nextTick(_ =&gt; {
  this.$refs.saveTagInput.$refs.input.focus()
})
</code></pre>
</li>
</ul>

            </div>
            
              <div class="tag-container">
                
                  <a href="https://shangxiaoyun.github.io/tag/RjiWSehJ7/" class="tag">
                    电商后台管理系统
                  </a>
                
              </div>
            
            
              <div class="next-post">
                <div class="next">下一篇</div>
                <a href="https://shangxiaoyun.github.io/post/quan-xian-lie-biao/">
                  <h3 class="post-title">
                    权限列表
                  </h3>
                </a>
              </div>
            

            

          </div>

        </div>
      </div>
    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
<script type="application/javascript">

AOS.init();

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>






  </body>
</html>
